# How to returns errors

* Для ошибок валидации или возникшие из-за полученных данных нужно возвращать ответ со кодом **4xx**
* Для сервера, не зависящих от клиента — **5xx**

Так-же в ответ рекомендуется включить заголовок **Date** с датой ошибки.

Для всех запросов, кроме HEAD, в ответе нужно указать текст ошибки. 

Если нужно передавать информацию для дебага, то её лучше включить в отдельный документ и добавить ссылку на него в теле или в заголовок **Link**.

Если ошибку логируются на сервере, то по возможности нужно передоставить идентификатор, по которому можно будет идентифицировать лог ошибки.

В информацию об ошибки стоит включать только обищие моменты, не стоит включать туда внутрение вещи, такие как стек-трейсы, ошибки из БД и т.п.

## Ошибки клиента: 4xx

* 400 (Bad Request) — возвращается когда серваер не может прочитать запрос клиента из-за синтетических ошибок. HTTP 1.1 определяет только одно состояние, при котором нужно отправлять это ошибку: Если запрос не включает заголовок **Host**
* 401 (Unauthorized) — возвращается когда клиент не имеет доступа к ресурсу, но получит его если будет авторизован. Если ресурс будет не доступен и для авторизованных пользователей, то нужно использовать 403.
* 403 (Forbidden) — возращается когда сервер не предоставляет доступа к ресурсы вообще.
* 404 (Not Found) — возвращается когда ресурс не может быть найден.
* 405 (Not Allowed) — возвращается когда метод HTTP не доступен для данного ресурса. В ответе стоит вернуть заголовок **Allow** с доступными методами для этого ресурса.
* 406 (Not Acceptable) — (7.7)
* 409 (Conflict) — возвращается при конфликте запроса и текущего состояния рессурса. Может включать тело ответа для пояснения.
* 410 (Gone) — возвращается когда ресурс существовал, но более не доступен. Обычно информация и прошлых ресурсах не хранится, поэтому, если нет такой необходимости, то можно использовать 404 вместо этого ответа.
* 412 (Precondition Failed) — (10.4)
* 413 (Request Entity Too Large) — возвращается когда теле POST или PUT слишком большое. В ответе стоит передавать информацию о лимитах.
* 415 (Unsupported Media Type) — возвращается когда медиа-тип запроса не поддерживается на сервере.

## Ошибки сервера: 5xx

* 500 (Internal Server Error) — общая ошибка серврера, подходит для болтшинства случаев.
* 503 (Service Unavailable) — возвращается когда сервер не может обработать запрос в данный момент времени. В ответ можно включить заголовок **Retry-After** с указанием длаты или количества секунд, когда можно будет попробовать повторить запрос.

## Тело ответа

Тело стоит включать во все ошибочные ответы, кроме HEAD запросов. Оно может содержать:
* Текст ошибки
* Подробное описание, как можно попробовать пофиксить проблему, если возможно
* Идентификатор ошибки
* Ссылку на информацию об ошибке с советами по её исправлению
