1. На схеме у нас имеются N-ное количество ЦОД, в каждом из который развернуты контейнеры с сервисами и контейнер с кластером БД, для оркестрации используется kubernetes.

   ЦОД работают одновременно в зависимости от геопозиции пользователя и загруженности (т.е. пользователь попадает на ближайший к нему ЦОД, если ЦОД сильно загружен то на следующий). В случае отказа одного из ЦОД трафик будет перераспределяться между рабочими.

   Восстановление будет происходить в следующем порядке:

   1. Поднимается кластер БД, т.к. БД необходима для работы большей части сервисов, в том числе наиболее важных, при необходимости происходит восстановление БД из бэкапа,
   2. Поднимаются сервисы каталога, заказа и цен, т.к. это наиболее важный функционал: оформление заказа, каталог и цены (без который оформление заказа будет невозможно, т.к. информация из каталога и цен нужна для создания заказа)
   3. Поднимается сервис клиентов, его отключение уже не критично, основной функционал сайта будет работать и без него, однако он напрямую взаимодействует с пользователем и его отсутствие и может сильно ухудшить опыт взаимодействия с сайтом
   4. Поднимается сервис производства, он наименее важен т.к. не влияет на основой функционал и сильно не ухудшает опыт взаимодействия с сайтом

2. Стратегии выката новых версий:

   - для тестирования новой технологии — Blue/Green, позволяет QA проверить новые фичи в prod окружении без воздействия на основных пользователей + последующее постепенное развёртывание новой версии позволяет убедится, что у пользователей тоже не возникает проблем с новой версией
   - для минорного изменения без времени простоя — Canary потому как минорные изменения не требуют такого тщательного тестирования на продакшене как новые фичи, а постепенное развертывание позволяет следить не возникли ли проблемы у пользователей и если проблемы есть, то быстро вернуть старую версию
   - для мажорного обновления без сохранения обратной совместимости работы с базой данных — Recreate т.к. изменения БД не позволяют постепенно выкатывать обновление. Важно в этом случае перед релизом иметь свежий бэкап старой версии базы, чтобы в случае серьёзных проблем можно было быстро откатиться на прошлую версию

3. Необходимо как минимум три стенда:

   - Production — где запущено лайв-приложение
   - Stage — наиболее приближенное к production окружение, где новый релиз тестируется окончательно, и если всё ок, то артефакт из stage отправляется на production
   - Dev — тестовая среда в которой тестируются все новые фичи и изменения, в отличии от stage здесь могут быты не только фичи идущие в релиз но и другие фичи над которыми идёт работа, но они ещё не готовы для релиза или не протестированы до конца