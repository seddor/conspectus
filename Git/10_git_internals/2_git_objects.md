# Объекты Git

Git — контентно-адрисуемая файловая система, т.е. по сути представляет из себя хранилище типа ключ-значение. В git можно добавить любые данные, в ответ он вернёт ключ по которым эти данные можно извлечь.

Добавляются объекты командой:
```bash
git hash-object 
```
* `-w` — указывает, что объект нужно сохранить, иначе просто выведет ключ без сохранения.
* `--stdin` — считать данные из потока ввода, иначе команда ожидает путь до файла.

В ответ команда вернёт ключ сохранённого объекта, ключ представляет из себя SHA-1 хэш, созданый из заголовка и содержимого объекта. Хэш состоит из 40 символов, первые 2 — директория в git-хранилище, 38 — имя файла.

Команда для получения содержимого файла по ключу:
```bash
git cat-file <key>
```
* `-p` — автоматическое определение типа содержимого и вывод на печать в удобном виде.
* `-t` — выводит тип файла.

## Деревья

Деревья позволяют хранить группы файлов вместе. Содержимое в git хранится в деревья и блобах, дерево соответствует директории на файловой системе, а блоб — содержимому файлов. 

Просмотр дерева последнего коммита:
```bash
git cat-file -p <branch>^{tree}
```
Примерно такой вывод:
```
100644 blob a906cb2a4a904a152e80877d4088654daad0c859      README
100644 blob 8f94139338f9404f26296befa88755fc2598c289      Rakefile
040000 tree 99f1a6d12cb4b6f19c8655fca46c3ecf317074e0      lib
```
Здесь файла являются блобами, а директории — деревьями.

Git обычно создаёт деревья на основе индекса, а затем сохраняет их в БД. 

Создание дерева из индекса:
```bash
git write-tree
```

Прочтение дерева:
```bash
git read-tree
```
* `prefix=<dir> <tree_key>` — прочитает дерево `<tree_key>` и сделает его поддеревом, в рабочем каталоге создатся директория `<dir>` содержащее содержимое дерева.

## Commit objects

Коммиты это особые объекты в git.
Создать коммит можно так:
```bash
echo 'commit message' | git commit-tree <tree_key>
```
Коммит выглядит так:
```
tree d8329fc1cc938780ffdd9f94e0d364e0ea74f579
author Scott Chacon <schacon@gmail.com> 1243040974 -0700
committer Scott Chacon <schacon@gmail.com> 1243040974 -0700

commit message
```
Т.е. содержит указание дерево верхнего уровня, имя автора и коммитера, временую метку, и через пустую строку сообщение коммита.
