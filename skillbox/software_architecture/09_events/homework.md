>Подумайте, какие сервисы системы имеет смысл перевести на событийную модель работы. Всю систему или только отдельные сервисы? Приведите бизнес-обоснование для сервисов, которые будут переведены на событийную модель. Каковы польза и риски такого решения?

Думаю, что события необходима ввести в основных сервисах системы (заказ, каталог клиенты), для сервиса цен будет достаточно команд.
Самый подходящий сервис для событийной модели — сервис заказов. В нём события можно использовать как для внутренней логики (уменьшений товара в базе данных, при создании заказа) так и для внешней аналитики (отправка данных заказа, при его создании, во внешние сервисы).
Для сервиса каталога события будут полезны для извещения об изменении товара, например, если товар изменит название или будет отключен, то сервис заказа узнает об этом и обновит информацию в корзине.
В сервисе клиентов можно генерировать событие по авторизации, которое можно использовать в сервисе заказов при работе с корзиной. Например, если пользоватлеь был не авторизован и положил товары в корзину, а потом авторизовался, и там у него тоже была корзина с другими товарами, то по авторизации можно или объеденить эти корзины или использовать какую-то из них. Событие при создании пользователя может быть использовано для отправки данных пользователя в какой-нибудь внешний сервис для аналитики или рассылок.
Риски от введения событий: события работают не явно, они могут генерироваться в одном сервисе обрабатываться в других, при этом у них нет четко заданого приоритета, что может привести к потенциальным багам, например если есть обработчик события который вносит какие-то измения в объект события, то это может повлиять на поведение последующих обработчиков. Также события усложняют логики систмы в целом, т.к. непонятно какие обработчики будут использоваться для события и как они могут повлиять в целом на систему, может быть сложно отловить какой-то баг возникающий при обработке собтия. Большое количество обработчиков не события может сказаться не проиводительности, если событие обрабатывается последовательно.

>Для выбранных в первом вопросе сервисов опишите основные агрегаты, их назначение и события/команды, которые они будут обрабатывать/генерировать. Результат представьте в виде перечисления и описания агрегатов. Составьте диаграмму событий/команд, покажите их связь, то есть на какие события или команды реагируют агрегаты.

# Сервис заказов

Заказ — содержит информацию о текущей корзине, заказе, товарах в корзине/заказе.

Генерируемые события/команды:
* Добавить товар в корзину — событие "товар добавлен в корзину"
* Удалить товар из корзины — событие "товар удален из корзины"
* Изменить товар в корзине — событие "товар изменен в корзине"
* Разместить заказ — событие "заказ размещен"
* Оплатить заказ — событие "заказ оплчаен" или "ошибка при оплате заказа"
* Изменить стауст заказа — событие "заказ изменил статус"
* Отменить заказ — событие "заказ отменён"

Обрабатываемые события/команды:
* Событие "Товар изменен" из сервиса каталога
* Событие "Товар удален" из сервиса каталога
* Команда "Цена товара создана" из сервиса цен
* Команда "Цена товара изменена" из сервиса цен
* Команда "Цена товара удалена" из сервиса цен
* Событие "Клиент авторизован" из сервиса клиентов
* Событие "Клиент создан" из сервиса клиентов
* Событие "Клиент удален" из сервиса клиентов

Склад — информация о наличии, количестве товара.

Генерируемые события/команды:
* Изменить количество товара — событие "количество товара на складе изменино"

Обрабатываемые события/команды:
* Событие "товар добавлен в корзину" из сервиса заказов
* Событие "товар удален из корзины" из сервиса заказов
* Событие "товар изменен в корзине" из сервиса заказов
* Событие "заказ рамещен" из сервиса заказов
* Событие "заказ изменил статус" из сервиса заказов
* Событие "заказ отменён" из сервиса заказов

# Сервис цен

Цена товара — информация о цене товара

Генерируемые события/команды:
* Созадть цену
* Изменить цену
* Удалить цену

# Сервис каталога

Товар — информация о товаре каталога

Генерируемые события/команды:
* Создать товар — событие "товар создан"
* Изменить товар — событие "товар изменён"
* Удалить товар — событие "товар удалён"

Обрабатываемые события/команды:
* Команда "новая цена товара создана" из сервиса цен
* Команда "цена товра изменена" из сервиса цен
* Команда "цена удалена" из сервиса цен
* Событие "количество товара на складе изменино" из сервиса заказов

# Сервис клиентов

Клиент — информация о клиенте и его адресах

Генерируемые события/команды:
* Создать клиента — событие "клиент создан"
* Изменить клиента — событие "клиент изменён"
* Удалить клиента — событие "клиент удалён"
* Авторизовать клиента — событие "клиент авторизован"
* Создать адрес клиента — событие "адрес клиент создан"
* Изменить адрес клиента — событие "адрес клиента изменён"
* Удалить адрес клиента — событие "адрес клиента удалён"

Обрабатываемые события/команды:
* Событие "заказ размещен" из сервиса заказов

>Выберите одну из цепочек событий (не менее 4-5 шагов) и распишите содержание команд/событий для этой цепочки. Обоснуйте выбор полей для описанных команд/событий. 

Цепочка событий для заказа:

1. Добавить товар в корзину, генерирует событие "товар добавлен в корзину".

* В команде передаётся товар.
* В событии передаётся товар и позиция заказа.
* Событие обрабатывает склад и, если для товара выполняются условия для скидки для локального склада, то уменьшается количество товаров на локальном складе

2. (Опционально) Если товар удалется/изменяется его количество, то генерируются соотвествующие события и, при условии примения к товару локальной цены, в обработчике события в складе меняется количество

* В команде передаётся товар.
* В событии передаётся товар и позиция заказа.

3. Разместить заказ генерирует "заказ размещен":

* В команде передаётся заказ.
* В событии передаётся заказ.
* Изменяет количество товаров на складе (если не было изменино ранее)
* Для авторизованого сохраняет новый адрес (если такой адрес ещё не сохранен)

4. Оплата заказа генирует "заказ оплачен" при удачной оплате или "ошибка при оплате"

* В команде передаётся заказ.
* В событии передаётся заказ.

5. Изменить статус закза генерирует "заказ изменил стаус"

* В команде передаётся заказ.
* В событии передаётся заказ.

6. (опционально) Отмень заказ генерирует "заказ отменён"

* В команде передаётся заказ.
* В событии передаётся заказ.

>На архитектурной диаграмме (общий план архитектуры с прошлых домашних заданий) отобразите 
необходимые технические компоненты для работы с командами и событиями. 
