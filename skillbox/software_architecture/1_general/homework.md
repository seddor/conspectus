# REST vs Messaging
 
## REST
 
Плюсы:
 
* Простота разработки. Не требует дополнительного ПО, нужно реализовать только нужный интерфейс для взаимодействия между сервисами.
* Консистентность данных. Запросы выполняются синхронно в определенном порядке, при создании заказа уже будут иметься данные по времени доставки.
 
Минусы:
* Зависимость сервисов. Один сервис зависит от другого, например, если сервис для расчета доставки не доступен клиент не сможет оформить заказ, что может быть критично.
* Скорость. Из-за синхронности возникает проблема с необходимостью дожидаться ответов от другого сервиса.
* Сложность масштабируемости. При добавлении новых сервисов, которым нужно будет знать о создании заказа нужно будет добавлять вызовы для них в сервис заказов при появлении каждого такого сервиса.
 
## Messaging
 
Плюсы:
* Независимость сервисов. Сервисы могут не зависеть друг от друга. При недоступности сервиса для подсчёта доставки можно создать заказ, а потом известить пользователя о датах доставки отдельно, когда сервис станет доступен.
* Простота масштабируемости. При появлении новых сервисов нет необходимости модифицировать текущие, достаточно просто сделать чтобы новые сервисы принимали сообщения от текущих.
 
Минусы:
* Сложность. Может потребоваться дополнительное ПО для работы с сообщениями.
* Возможно неконсистентность данных. Т.е. в заказы могут не получить время доставки, если сервис был недоступен.
 
## Факторы
 
* Важна ли консистеность данных — обязательно ли в заказе должна быть определённая дата доставки или заказ может быть создан и обработан без неё.
* Важно ли время доставки — например, если интернет магазин продаёт что-то что в большинстве случаев важно доставить к какому-то времени (цветы/подарки и т.д.) то важно чтобы пользователь всегда получал точное время доставки, а в случае отказа сервиса расчета времени получал сообщения об ошибке, без создания заказа.
 
 
# БД
 
## Общая
 
Плюсы:
* Простата. Данные хранятся в одном месте, их легко запрашивать и записывать.
* Возможность использования одних структур. Т.е. разные сервисы могут писать в одни таблицы, дописывая данные. Например дату доставки можно записать в таблицу с заказом, не создавая новые структуры для этого.
Минусы:
* Зависимость. Оба сервиса зависимы от одной базы, следовательно при проблеме с сервером БД становятся недоступны оба сервиса.
* Блокировка, возможные дедлоки. Сервисы могут одновременно запрашивать одни и те же таблицы, один сервис может заблокировать таблицу, тем самым мешая работе остальных сервисов, которые будут вынуждены ждать.
 
## Раздельная
 
Плюсы:
* Независимость. Каждый сервис имеет свою базу, они могут хранится на разных серверах, при недоступности одного сервиса другой продолжит работать.
* Отсутствие блокировок между сервисами. Т.к. каждый сервис работает со своей базой, они не будут блочить таблицы друг для друга, соответственно долгий запрос к БД в одном сервисе никак не повлияет на выполнение запросов к БД других сервисов.
Минусы:
* Сложность. Данные хранятся в разных местах, для получения полной информации нужно обращаться к нескольким базам, при недоступности каких-то сервисов данные могут быть неполные.
 
## Факторы
 
* Связанность данных. Насколько сильно данные должны быть связаны между собой, нужно ли писать из в общую таблицу, или можно распределить.
* Консистентность. Важно ли чтобы обязательно были записыны все данные для создания заказа, или важно создать заказ, а остальные данные дописывать уже потом.
* Работа под нагрузкой, скорость. Насколько критичная скорость записи в БД, будет ли проблемой взаимная блокировка таблиц разными сервисами?

## Дополнение для задачи 1
 
### REST
 
Первоначальная сложность и стоимость разработки невысокая, нужно только спроектировать и реализовать API посредством которого будут общаться сервисы.
В дальнейшем поддержка усложняется, при добавлении новых сервисов нужно дорабатывать текущие сервисы, добавлять в них вызовы к новым сервисам, если им необходимы данные из этих сервисов. Также при изменении API сервиса может сломать вызовы к нему, такие моменты нужно проверять при изменениях (тестами или вручную).
К API желательно иметь документацию, которую тоже нужно не забывать обновлять (или использовать инструменты для генерации автоматической документации, например swagger).
Использование REST подойдёт больше для небольших систем, не требующих высокую производительность и отказоустойчивость или если в системе важна синхронность. Если нужно обрабатывать множество данных и предполагается, что количество сервисов будет большое, то лучше присмотреться к Messaging.
 
### Messaging
 
Первоначальная сложность разработки выше, чем у REST, нужно реализовать механизмы отправки/приема сообщений для сервисов, для самих сообщений нужно использовать какой-нибудь message broker (ActiveMQ, RabbitMQ) с которыми тоже нужно разбираться дополнительно.
Если система спроектирована правильно то поддерживать её будет проще. По идее модули напрямую не взаимодействуют между собой, поэтому им не нужно знать друг о друге, при добавлении новых модулей достаточно только добавить отправку/получения сообщений для нужных модулей. Благодаря сохранению/логированию сообщений в случае возникновения проблем проще отследить конкретные кейсы при каких данных возникла ошибка.
Стоит также отметить, что архитектура с сообщениями обладает большей отказоустойчивостью, необработанные сообщения хранятся в меседж брокере а, в случае падения системы, сообщения продолжат обрабатываться после восстановления.
Использование Messaging больше подходит для больших систем, требующих обработку больших объемов информации и высокую производительность. Для маленьких систем использование Messaging будет затратно и излишне, лучше использовать REST.
