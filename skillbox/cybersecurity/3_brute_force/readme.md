# Атаки грубой силы

## Работа с хешами

В целях безопасности парол хешируются и преобзрауются в строку фиксированной длины.

Чтобы определить алгоритма хеширования можно воспользоваться утилитой hashID:
```bash
hashid <hash>
```
В результатае будет выведен список наиболее вероятных алогоритмов хеширования.

Можно добавить опции `-m` и `j`. Тогда в результае будут отображены режимы для утилит [hashcat](https://hashcat.net/hashcat/) и [john the ripper](https://www.openwall.com/john/) программ для брут форма хешей.


[Онлайн дешифратор хешей](https://crackstation.net/)

## Атака полного перебора

Данная атака самая надёжная, но самая медленная, она состоит в полном переборе значений.

### hashcat

[hashcat](https://hashcat.net/hashcat/) — утилита для подбора хешей.

Имеет несколько режимов работы:
* 0 — атака по словарю, при её использовании будет использован словарь наиболее популярных паролей. Главный недостаток: зависимость от словарей
* 1 — комбинаторный, использует два словаря совмещая их значений
* 3 — атака полного перебора или атака по маске, в данном режиме программе будет подбирать хэш по указанной маске
* 6 и 7 — кобинация ранее описанных атак

Символы при поиске по маске:
* l — lowerspace — все символы в пароле не являются заглавными
* u — upperspace — все символы являются заглавными
* d — все символы являются целочисленными
* h — все символы являются целочисленными или не заглавными
* H — все символы являются целочисленными или заглавными
* s — обозначает специальные символы
* a — обозначает любой символ

Пример запроса:
```
hashcat -m <режим подбора алгоритма (можно получить из hashid)> -a <режим работы> <хэш> <маска>
hashcat -m 0 -a 3 098f6bcd4621d373cade4e832627b4f6 ?a?a?a?a --potfile-disable
```
Для добавление символов для подбора можно использовать словари идущие в комплекте, найти их можно командой:
```bash
locate .hcchr
```
команда может не работать, тогда нужно обновить базу:
```bash
sudo updated
```
Для использования нужно добавить опцию `-1 <путь к таблице символов>`

Также можно использовать пользовательские маски хранимые в файлах .hcmask

Стоит обратить внимание, что hashcat работает с байтами, а не символами, поэтому для многобитных кадировок нужно соотвено указывать нужную размерность в маске.

## Атака по словарю и гибридные атаки

### Атака по словарю

rockyou.txt — словаря наиболее популярных паролей.

Для использования:
```bash
hashcat -a 0 -m 17600 <хэш> rockyou.txt
```

### Комбинаторная атака

Комбнарторная атака разделяет хэш на две части и ищет по двум словорям:
```bash
hashcat -a 1 -m 1700 <словарь_1> <словарь_2>
```
Можно указать дополнительные правила, например `-j` позволяет указать дополнительный символ, который будет установлен после словаря:
```
hashcat -a 1 -m 1700 <словарь_1> <словарь_2> -j '$-` -K `$?`
```
* -j — для левого списка
* -K — для правого списка

### Атака на основе правил

Наиболее сложный вариант атаки, для правил используется особый язык.

### Гибридная атака

Позволяет использовать словарь и маску одновременно.
```
hashcat -a 6 -m 0 <хэш> <словарь> <маска>
```

## Дополнительные возможности

### Генератор словарей

Для создания можно использовать maskprocessor:
```
mp64 ?uohn?d?d?d?d -o johnlist
```

### Дополнительно

[GUI для john the ripper](https://github.com/openwall/johnny)
[GUI для hashcat](https://github.com/Rich5/oclHashcat)
[Пакет утилит для hashcat](https://hashcat.net/wiki/doku.php?id=hashcat_utils)

## Атака на системные пароли

В Linux есть два файла для хранения критической информации:
* /etc/passwd — включает информацию о группах пользователей, номера их учетных записей и домашних директорий. Доступен в режиме только для чтения и не требует прав рута.
* /etc/shadow — содержит информацию о типе хеша пароля, соль, сам хэш и метаданные о сроке действия. Для чтения и редактирования нужны права рута. Подробнее в pdf.

Соль — набор данных, которые добавляются к паролю, после чего алгортим хешируются.

/etc/login.defs — содержит информацию для хеширования паролей.

## Радужные таблицы

Суть таблиц в том, что при их использовании генерация хеша не происходит, а происходит поиск по уже вычесленным результатам. Для экономии используются цепочки хеширования, их суть в том что значения упаковывается в специальные блоки. Искомые хеши не генерируются, и сверяются на наличие в той или иной цепочке.

Для осуществления такой атаки нужна утилита [RainbowCrack](https://project-rainbowcrack.com/) и таблица которую можно взять [здесь](https://freerainbowtables.com/)

Применяются только к крипкостойким паролям, они менее эффективны с точки зрения брутфорс атак.

## Альтернативные инструменты взлома

[John the rippe](https://github.com/openwall/john)
