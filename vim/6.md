# Глава 6

## Управление несколькими файлами

Vim позволяет работать с несколькими файлами одновременно.

### Слежение за открытыми файлами с помощью списка буферов

В процессе сеанса работы с vim можно загружать множество файлов и управлять ими с помощью списка буферов. Во время работы с файлом vim использует буфер, до записи на диск vim хранит изменения в буфере в оперативной памяти.

Большинство команд в vim работают с буферами, но есть те которые работают с файлами: `:write`, `:update`, `:saves`.

В vim можно работать с несколькими буферами одновременно.

При открытии файла по шаблоны, например `*.txt` vim откроет одно окно с перым файлом, остальные будут помещены в буфер.

`:ls` — просмотр списка буферов. В списке `%a` — текущий буфер, `#` — альтернативный файл, `+` — в буфере есть несохраненные изменения.

`:bnext` — переключить буфер на следующий

`:bprev` — переключить буфер на предыдущий

`:bfirts` — переход в начала списка буферов

`:blast` — переход в конец списка буферов

`:buffer <N>` — переход к буферу с номером `<N>`

`cntrl+^` — переключение файлов, переключение возможно только после переключения буфера.

`:bufdo` — применить команду Ex ко всем буферам, перечисляемым командой `:ls`.

При открытии нового файла vim создаёт новый буфер.

`:bdelete <N>` — удаление буфера `<N>`, в `<N>` можно использовать диапазоны.

### Группировка буферов с помощью списка аргументов

К каждому элементу списка аргументов можно применять команды Ex, используя команду `:argdo`.

`:args` — просмотр списка аргументов. Список аргументов представляет из себя список файлов, которые были переданы vim, в случае передачи аргумента со `*` в списке аргументов `*`  разворачивается до реальных имен файлов, подошедших под шаблон. В `[]` заключается текущий аргумент.

`:args {arglist}` — изменить содержимое списка аргументов. Аргумент `{arglist}` может включать имена файлов, групповые символы и вывод команды оболочки.

Групповые символы:

* `*` — соответствует нулю и более символам, но только в пределах указанного каталога
* `**` — соответствует нулю и более символов, с включением подкаталогов

Групповые символы допускается объединять с фрагментами имен файлов и каталогов для составления шаблонов.

Текст заключённый в обратные кавычки в `{arglist}` vim выполнит в командной оболочке.

`:next` —  переключение на следующий аргумент

`:prev` — переключение на предыдущий аргумент

### Управление скрытыми файлами

При переключении между буферами, если в текущем есть несохраненные изменения vim будет выдавать предупреждение и не переходить между буферами. Чтобы переключение произошло нужно указать `!` в конце команды, например: `:bnext!`, тогда буфер будет переключен, а прошлый буфер будет помечен как hidden.

Наличие скрытых буферов никак не влияет на работу vim, только при попытке завершения сеанса vim напомнит о них и не даст выйти, если не сохранить изменения.

`:write` — запись изменений из буфера в файл

`:edit!` — прочитает файл с диска и затрёт изменения в буфере.

 `:qall!` — закрыть vim, игнорирую несохраненные буферы

`:wall` — сохранение всех несохраненных буферов

### Деление рабочего пространства на окна

Окно — ограниченная область рабочего пространства в котором отображается содержимое буфера.

`<cntrl+w>s` /`sp[lit] <file>`— создаст окно по горизонтали

`<cntrl+w>v`/`vsp[lit] <file>` — создаст окно по вертикали

`<cntrl+w>w` — переключение между окнами в цикле

`<cntrl+w>h` — переключение на окно слева

`<cntrl+w>j` — переключение на онко справа

`<cntrl+w>k` — переключение на онко выше

`<cntrl+w>l` — переключение на онко справа

`<cntrl+w>c`/`:close` — закрыть активное окно

`<cntrl+w>o`/`:only` — закрыть все окна, кроме активного

`<cntl+w>=` — выровнит ширину и высоту всех окон

`<cntl+w>_` — увеличит высоту активного окна до предела

`<cntl+w>|` — увеличит ширину активного окна до предела

`[n]<cntrl+w>_` — установит высоту активного окна до n  строк

`[n]<cntrl+w>|` — установит ширину активного онка до n столбцов

### Использование вкладов

Вкладка — контейнер позволяющий хранить коллекцию окон.

`:tabedit {filename}` — если опустить аргумент `{filename}` то vim создаст новую вкладку с пустым буфером.

Если текущая вкладка содержит несколько окон, то нажатие `<cntrl+w>T` переместит текущее окно на новую вкладку.

`:tabclose` — закрыть текущую вкладку

`:tabonly` — закрыть все вкладки, кроме текущей

`{n}gt` — переключение на вкладку номер `n`. Если номер не указывать, то произойдёт переход к следующей вкладке.

`gT` — переход к предыдущей вкладке

`:tabmove [N]` — переместить вкладку на `N`, если передать 0 то вкладка переместится в начало, если не передавать то в конец

